---
title: "Milestone 3 Group 10"
output: html_document
date: "2024-11-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## We exported cleaned data sets for medicare, medicaid, mortality and population data as csv files into our Project 251 folder from Milestone 2 Rmd file. We shall now import the medicare, mortality and population cleaned data sets into the Milestone 3 Rmd file for preparation for further analysis. 

#We have chosen to use the medicare data (65+) to be prepared for merging with mortality and population data sets.

```{r}
library(readr)
setwd("/home/rstudio/Project251/data_sets_for_milestone_3")

medicare_data <- read_csv('medicare_data_cleaned.csv')
medicaid_data <- read_csv('medicaid_data_cleaned.csv')
cdc_wonder_mortality_data <- read_csv("cdc_wonder_mortality_data_cleaned.csv")
cdc_wonder_population_data <- read_csv("cdc_wonder_population_data_cleaned.csv")

head(medicaid_data)
head(medicare_data)
head(cdc_wonder_mortality_data)
head(cdc_wonder_population_data)

```

##RECODING COMMON VARIABLES TO BE COMBINED WITH OTHER DATA SETS and COVERTING PAYMENT VARIABLES TO NURMERIC
=======

#Renamed the first column to residence_state as is in the mortatility data sets, select the first three columns with totals on enrolemnt, utilisation  and payments, and remove the "UNITED STATES" row with totals. We have capitalised each word in the sate name bu converted them to lower case as is the case in the mortality dataset.
#Removed dollar signs and commas from the program payments, then converted the column data to numeric.

#Removed dollar signs and commas from the program payments, then converted the column variables to numeric.

``` {r}
library(stringr)
library(dplyr)

medicare_data_modified <- medicare_data %>% 
  select(residence_state = location, 
         total_traditional_medicare_part_a_and_or_part_b_enrollees, 
         total_medicare_part_a_and_or_part_b_persons_with_utilization, 
         total_medicare_part_a_and_or_part_b_program_payments) %>% 
  filter(residence_state != 'UNITED STATES') %>%
  mutate(
    residence_state = str_to_title(tolower(residence_state)), 
    residence_state = ifelse(residence_state == "District Of Columbia", "District of Columbia", residence_state)
  )

medicare_data_modified <- medicare_data_modified %>%
  mutate(total_medicare_part_a_and_or_part_b_program_payments = 
           as.numeric(gsub("[\\$,]", "", total_medicare_part_a_and_or_part_b_program_payments)))

head(medicare_data_modified)

str(medicare_data_modified)
```
#RECODING FOR CDC MORTAILITY DATA
``` {r}
mortality_modified <- cdc_wonder_mortality_data %>% 
  filter(ten_year_age_groups %in% c('65-74 years', '75-84 years', '85+ years')) %>% 
  select(residence_state, ten_year_age_groups, deaths)


mortality_modified<- mortality_modified %>% 
  group_by(residence_state, ten_year_age_groups) %>% 
  summarize(total_deaths = sum(deaths), .groups = 'drop')

head(mortality_modified)
str(mortality_modified)


```

```{r}
mortality_65_plus <- mortality_modified %>% 
  group_by(residence_state) %>% 
  summarize(total_deaths_65_plus = sum(total_deaths), .groups = 'drop')

head(mortality_65_plus)
```


#RECODING FOR CDC POPULATION DATA
``` {r}

population_data_modified<- cdc_wonder_population_data %>%
  rename(residence_state = state)  %>% 
  filter(grepl('65|74|84|85+', ten_year_age_groups))


head(population_data_modified)
str(population_data_modified)
```
